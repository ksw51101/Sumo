<!DOCTYPE html>

<html lang="en">
<head>
  <title>Simulation/Traffic_Lights - Eclipse SUMO - Simulation of Urban Mobility</title>
  <meta charset="UTF-8">
  <link rel="stylesheet" type="text/css" href="../sumo.css">
  <link rel="license" href=
  "http://creativecommons.org/licenses/by-sa/3.0/">
</head>

<body id="bmission">
  <div id="container">
    <div id="logo" style="text-align:left">
      <img src="../logo.png" width="374" height="128"
      alt="SUMO-Simulation of Urban Mobility" style=
      "float:left; margin-left:10px; margin-right:20px;">
      <div id="logo_text1">&nbsp;</div>
      <div id="logo_text2">&nbsp;</div>
    </div>

    <div id="subsMenu">
      <ul>
        <li class="sub"><a href=
        "http://sumo.dlr.de/">Home</a></li>

        <li class="sub"><a href="../Downloads.html">Download</a></li>

        <li class="sub"><a href="../index.html">Documentation</a></li>

        <li class="sub"><a href=
        "http://sumo.dlr.de/wiki/">Wiki</a></li>

        <li class="sub"><a href=
        "https://github.com/eclipse/sumo/issues">Issue Tracker</a></li>

        <li class="sub"><a href="../Contact.html">Contact</a></li>

        <li class="sub"><a href=
        "https://github.com/eclipse/sumo">GitHub Project</a></li>
      </ul>
    </div>

    <div id="nav">
      <div id="step1">
        <h3>User</h3>
        <ul>
        <!-- nav begins --> <li>Introduction</li>
<li style="list-style: none; display: inline"><ul>
  <li><a href="../Sumo_at_a_Glance.html">The traffic simulation SUMO</a></li>
</ul></li>
  <li>Basic Usage</li>
<li style="list-style: none; display: inline"><ul>
  <li><a href="../Basics/Notation.html">Notation in this Documentation</a></li>
  <li><a href="../Basics/Basic_Computer_Skills.html">Needed, basic Computer Skills</a></li>
  <li><a href="../Installing.html">Installing SUMO</a></li>
  <li><a href="../Basics/Using_the_Command_Line_Applications.html">Using SUMO Command Line Applications</a></li>
  <li><a href="../Tutorials.html">Tutorials</a></li>
  <li><a href="../XMLValidation.html">Validating application inputs</a></li>
</ul></li>
  <li>Network Building</li>
<li style="list-style: none; display: inline"><ul>
  <li><a href="../Networks/SUMO_Road_Networks.html">SUMO Road Networks</a></li>
  <li><a href="../Networks/Abstract_Network_Generation.html">Abstract networks generation</a></li>
  <li><a href="../NETCONVERT.html">NETCONVERT</a></li>
<li style="list-style: none; display: inline"><ul>
   <li><a href="../Networks/Building_Networks_from_own_XML-descriptions.html">Defining own networks using XML</a></li>
   <li><a href="../Networks/Import.html">Importing non-SUMO networks</a></li>
<li style="list-style: none; display: inline"><ul>
    <li><a href="../Networks/Import/OpenStreetMap.html">from OpenStreetMap</a></li>
<li style="list-style: none; display: inline"><ul>
     <li><a href="../Networks/Import/OpenStreetMap.html#3-click_scenario_generation">3-Click Scenario Generator</a></li>
</ul></li>
    <li><a href="../Networks/Import/VISUM.html">from VISUM</a></li>
    <li><a href="../Networks/Import/Vissim.html">from Vissim</a></li>
    <li><a href="../Networks/Import/OpenDRIVE.html">from OpenDRIVE</a></li>
    <li><a href="../Networks/Import/MATsim.html">from MATsim</a></li>
    <li><a href="../Networks/Import/ArcView.html">from ArcView (shapefiles)</a></li>
    <li><a href="../Networks/Import/DlrNavteq.html">from DlrNavTeq</a></li>
    <li><a href="../Networks/Import/RoboCup.html">from Robocup Simulation League</a></li>
</ul></li>
   <li><a href="../Networks/Import/SUMO_Road_Networks.html">Importing SUMO networks</a></li>
   <li><a href="../Simulation/Motorways.html#Building_a_network_for_motorway_simulation">Building networks for motorway simulation</a></li>
   <li><a href="../Simulation/Pedestrians.html#Building_a_network_for_pedestrian_simulation">Building networks for pedestrian simulation</a></li>
   <li><a href="../Networks/Further_Options.html">Further NETCONVERT options</a></li>
   <li><a href="../Networks/Further_Outputs.html">Additional output</a></li>
</ul></li>
  <li><a href="../NETEDIT.html">Creating and modifying networks with NETEDIT</a></li>
  <li><a href="../Networks/Elevation.html">Including elevation data</a></li>
  <li><a href="../Geo-Coordinates.html">Geo-Coordinates</a></li>
</ul></li>
  <li>Demand Modelling</li>
<li style="list-style: none; display: inline"><ul>
  <li><a href="../Demand/Introduction_to_demand_modelling_in_SUMO.html">Introduction to SUMO Demand Modelling</a></li>
  <li><a href="../Definition_of_Vehicles,_Vehicle_Types,_and_Routes.html">Definition of Vehicles, Vehicle Types, and Routes</a></li>
  <li><a href="../Simulation/Public_Transport.html">Simulation of public transport</a></li>
  <li><a href="../Specification/Persons.html">Simulation of individual persons and trip chains</a></li>
  <li><a href="../Specification/Logistics.html">Simulation of logistics</a></li>
  <li><a href="../Demand/Shortest_or_Optimal_Path_Routing.html">Shortest or Optimal Path Routing</a></li>
  <li><a href="../IntermodalRouting.html">Intermodal Routing</a></li>
  <li><a href="../Demand/Automatic_Routing_.html">Routing in the Simulation</a></li>
  <li><a href="../Demand/Dynamic_User_Assignment.html">Computing Dynamic User Assignment</a></li>
  <li><a href="../Simulation/Pedestrians.html#Generating_pedestrian_demand">Generating pedestrian traffic demand</a></li>
  <li><a href="../Tools/Misc.html#createVehTypeDistributions.py">Generate a vehicle type distribution to model the fleet</a></li>
</ul></li>
  <li>Data sources for demand generation</li>
<li style="list-style: none; display: inline"><ul>
  <li><a href="../Demand/Importing_O/D_Matrices.html">Importing O/D Matrices</a></li>
<li style="list-style: none; display: inline"><ul>
   <li><a href="../Demand/Further_Ways_to_import_VISUM_Demand_Definitions.html">Other VISUM Demand Importers</a></li>
   <li><a href="../Demand/Further_Ways_to_import_Vissim_Demand_Definitions.html">Other Vissim Demand Importers</a></li>
</ul></li>
  <li><a href="../Demand/Routes_from_Observation_Points.html">Routes from Observation Points</a></li>
  <li><a href="../Demand/Routing_by_Turn_Probabilities.html">Routing by Turn Probabilities</a></li>
  <li><a href="../Demand/Activity-based_Demand_Generation.html">Activity-based Demand Generation</a></li>
  <li><a href="../Tools/Trip.html#randomTrips.py">Random Trips</a></li>
  <li><a href="../Tools/Import/OSM.html#osmWebWizard.py">Multi-modal random traffic</a></li>
</ul></li>
  <li>Simulation</li>
<li style="list-style: none; display: inline"><ul>
  <li><a href="../Simulation/Basic_Definition.html">Basic Definition</a></li>
  <li><a href="../Simulation/Output.html">Simulation output</a></li>
  <li><a href="../TraCI.html">TraCI (On-line Interaction)</a></li>
  <li><a href="../Simulation/SaveAndLoad.html">Saving and Loading Simulation State</a></li>
</ul></li>
  <li> Traffic Management and Other Structures </li>
<li style="list-style: none; display: inline"><ul>
  <li><a href="../Simulation/Traffic_Lights.html">Traffic Lights</a></li>
  <li><a href="../Simulation/Public_Transport.html">Public Transport</a></li>
  <li><a href="../Simulation/Variable_Speed_Signs.html">Variable Speed Signs</a></li>
  <li><a href="../Simulation/Rerouter.html">Rerouter / Alternative Route Signage</a></li>
  <li><a href="../Simulation/Vaporizer.html">Vaporizer</a></li>
  <li><a href="../Simulation/Calibrator.html">Dynamic calibration of flow and speed</a></li>
  <li><a href="../Simulation/ParkingArea.html">Parking areas</a></li>
</ul></li>
  <li> Traffic Modes </li>
<li style="list-style: none; display: inline"><ul>
  <li><a href="../Simulation/Pedestrians.html">Pedestrian simulation</a></li>
  <li><a href="../Simulation/Bicycles.html">Bicycle simulation</a></li>
  <li><a href="../Simulation/Railways.html">Railway simulation</a></li>
  <li><a href="../Simulation/Waterways.html">Waterway simulation</a></li>
</ul></li>
  <li> Additional Features </li>
<li style="list-style: none; display: inline"><ul>
  <li><a href="../Models/Emissions.html">Emissions</a></li>
  <li><a href="../Models/Electric.html">Electric Vehicles</a></li>
  <li><a href="../Specification/Logistics.html">Logistics</a></li>
  <li><a href="../Simulation/GenericParameters.html">Generic Parameters</a></li>
  <li><a href="../Simulation/Shapes.html">Shapes Visualisation</a></li>
  <li><a href="../Simulation/Bluetooth.html">Wireless Device Detection</a></li>
  <li><a href="../Simulation/Emergency.html">Emergency Vehicles</a></li>
</ul></li>
  <li> Model details </li>
<li style="list-style: none; display: inline"><ul>
  <li><a href="../Simulation/VehicleSpeed.html">Vehicle speed</a></li>
  <li><a href="../Simulation/VehicleInsertion.html">Vehicle insertion</a></li>
  <li><a href="../Simulation/VehiclePermissions.html">Vehicle permissions (access restrictions)</a></li>
  <li><a href="../Simulation/Intersections.html">Intersection dynamics</a></li>
  <li><a href="../Simulation/Randomness.html">Randomness</a></li>
  <li><a href="../Simulation/Routing.html">Routing and Re-routing</a></li>
  <li><a href="../Simulation/SublaneModel.html">Sublane Model</a></li>
  <li><a href="../Simulation/OppositeDirectionDriving.html">Opposite Direction Driving</a></li>
  <li><a href="../Simulation/Safety.html">Safety</a></li>
  <li><a href="../Simulation/Meso.html">Mesoscopic model</a></li>
</ul></li>
  <li> Common Problems </li>
<li style="list-style: none; display: inline"><ul>
  <li><a href="../Simulation/Why_Vehicles_are_teleporting.html">Why Vehicles are teleporting</a></li>
  <li><a href="../FAQ.html#The_simulation_has_lots_of_jams.2Fdeadlocks._What_can_I_do.3F">Unexpected jamming</a></li>
  <li><a href="../FAQ.html#Why_do_the_vehicles_perform_unexpected_lane-changing_maneuvers.3F">Unexpected lane-changing maneuvers?</a></li>
  <li><a href="../FAQ.html#How_do_I_get_high_flows.2Fvehicle_densities.3F">How to get high flows?</a></li>
</ul></li>
  <li><a href="../Tools/Main.html">Additional Tools</a></li>
<li style="list-style: none; display: inline"><ul>
  <li><a href="../Tools/Main.html">Tool index</a></li>
  <li><a href="../Tools/Import/OSM.html#osmWebWizard.py">osmWebWizard</a></li>
  <li><a href="../TraCI/Interfacing_TraCI_from_Python.html">TraCI/Interfacing_TraCI_from_Python</a></li>
  <li><a href="../Tools/Sumolib.html">Reading SUMO networks and outputs with Python (sumolib)</a></li>
  <li><a href="../Tools/Xml.html">Tools for converting SUMO outputs to CSV/Spreadsheet</a></li>
  <li><a href="../Tools/TraceExporter.html">Exporting mobility Traces (traceExporter)</a></li>
  <li><a href="../Tools/Net.html#netdiff.py">Determining the differences between two networks</a></li>
  <li><a href="../Tools/Visualization.html">Tools/Visualization</a></li>
</ul></li>
  <li>Theory</li>
<li style="list-style: none; display: inline"><ul>
  <li><a href="../Theory/Traffic_Simulations.html">Traffic simulations in general</a></li>
</ul></li>
  <li>Application Manuals</li>
<li style="list-style: none; display: inline"><ul>
  <li><a href="../SUMO.html">SUMO</a></li>
  <li><a href="../SUMO-GUI.html">SUMO-GUI</a></li>
  <li><a href="../NETCONVERT.html">NETCONVERT</a></li>
  <li><a href="../NETEDIT.html">NETEDIT</a></li>
  <li><a href="../NETGENERATE.html">NETGENERATE</a></li>
  <li><a href="../OD2TRIPS.html">OD2TRIPS</a></li>
  <li><a href="../DUAROUTER.html">DUAROUTER</a></li>
  <li><a href="../JTRROUTER.html">JTRROUTER</a></li>
  <li><a href="../DFROUTER.html">DFROUTER</a></li>
  <li><a href="../MAROUTER.html">MAROUTER</a></li>
  <li><a href="../POLYCONVERT.html">POLYCONVERT</a></li>
  <li><a href="../ACTIVITYGEN.html">ACTIVITYGEN</a></li>
  <li><a href="../Tools/Emissions.html">EMISSIONSMAP</a></li>
  <li><a href="../Tools/Emissions.html">EMISSIONSDRIVINGCYCLE</a></li>
</ul></li>
  <li>Appendices</li>
<li style="list-style: none; display: inline"><ul>
  <li><a href="../ChangeLog.html">ChangeLog</a></li>
  <li><a href="../Other/Glossary.html">Glossary</a></li>
  <li><a href="../FAQ.html">FAQ</a></li>
  <li><a href="../Tools/Main.html">Additional Tools</a></li>
  <li><a href="../Other/File_Extensions.html">Known File Extensions</a></li>
</ul></li>
<!-- nav ends -->
        </ul>
      </div>

      <div id="step2">
        <h3>Further Resources</h3>

        <ul>
          <li><a href="../Data/Networks.html">Example Networks</a></li>

          <li><a href="../Data/Scenarios.html">Example Scenarios</a></li>

          <li><a href="../Data/Traffic_Data.html">Traffic Data</a></li>
        </ul>
      </div>

      <div id="step3">
        <h3>Developer</h3>

        <ul>
          <li><a href="../Developer/Main.html">Developer Docs</a></li>

          <li><a href="http://sumo.dlr.de/daily/">Daily Test Status</a></li>

          <li><a href="../../doxygen/">Doxygen Documentation</a></li>

          <li>Python Modules Documentation</li>

          <li style="list-style: none; display: inline">
            <ul>
              <li><a href="../../pydoc/traci.html">traci</a></li>

              <li><a href="../../pydoc/sumolib.html">sumolib</a></li>
            </ul>
          </li>

          <li>Java Modules Documentation</li>

          <li style="list-style: none; display: inline">
            <ul>
              <li><a href="../../javadoc/traas/">TraaS</a></li>
            </ul>
          </li>
        </ul>
      </div>
    </div>

    <div id="content">
      <a id="top"></a>
			<div class="mw-indicators mw-body-content">
</div>
<h1 id="firstHeading" class="firstHeading" lang="en">Simulation/Traffic Lights</h1>			<div id="bodyContent" class="mw-body-content">
				<div id="siteSub" class="noprint">generated on 2019-04-16 00:19:10.174787 from <a href="https://sumo.dlr.de/wiki/Simulation/Traffic_Lights">the wiki page for Simulation/Traffic_Lights</a> for SUMO 1.2.0</div>				<div id="contentSub"></div>
								
				
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output"><p>Normally, <a href="../NETCONVERT.html" title="NETCONVERT">NETCONVERT</a> and <a href="../NETGENERATE.html" title="NETGENERATE">NETGENERATE</a> generate traffic lights and programs for junctions during the computation of the networks. Still, these computed programs quite often differ from those found in reality. To feed the simulation with real traffic light programs, it is possible to run <a href="../SUMO.html" title="SUMO">SUMO</a>/<a href="../SUMO-GUI.html" title="SUMO-GUI">SUMO-GUI</a> with additional program definitions. Also, <a href="../SUMO.html" title="SUMO">SUMO</a>/<a href="../SUMO-GUI.html" title="SUMO-GUI">SUMO-GUI</a> allow loading definitions which describe when and how a set of traffic lights can switch from one program to another. Both will be discussed in the following subchapters. Another possiblity is to edit traffic light plans visually in <a href="../NETEDIT.html#Traffic_Lights" title="NETEDIT">NETEDIT</a>.
</p>
<div id="toc" class="toc"><input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none" /><div class="toctitle" lang="en" dir="ltr"><h2>Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Automatically_Generated_TLS-Programs"><span class="tocnumber">1</span> <span class="toctext">Automatically Generated TLS-Programs</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Default_4-arm_intersection_.28layout_opposites.29"><span class="tocnumber">1.1</span> <span class="toctext">Default 4-arm intersection (layout <i>opposites</i>)</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Intersection_layout_incoming"><span class="tocnumber">1.2</span> <span class="toctext">Intersection layout <i>incoming</i></span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Other_Intersections"><span class="tocnumber">1.3</span> <span class="toctext">Other Intersections</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Improving_Generated_programs_with_knowledge_about_traffic_demand"><span class="tocnumber">1.4</span> <span class="toctext">Improving Generated programs with knowledge about traffic demand</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Defining_New_TLS-Programs"><span class="tocnumber">2</span> <span class="toctext">Defining New TLS-Programs</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#.3CtlLogic.3E_Attributes"><span class="tocnumber">2.1</span> <span class="toctext">&lt;tlLogic&gt; Attributes</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#.3Cphase.3E_Attributes"><span class="tocnumber">2.2</span> <span class="toctext">&lt;phase&gt; Attributes</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Signal_state_definitions"><span class="tocnumber">2.3</span> <span class="toctext">Signal state definitions</span></a>
<ul>
<li class="toclevel-3 tocsection-10"><a href="#Default_link_indices"><span class="tocnumber">2.3.1</span> <span class="toctext">Default link indices</span></a></li>
<li class="toclevel-3 tocsection-11"><a href="#Accessing_indices_programmatically"><span class="tocnumber">2.3.2</span> <span class="toctext">Accessing indices programmatically</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-12"><a href="#Viewing_TLS-Programs_graphically"><span class="tocnumber">2.4</span> <span class="toctext">Viewing TLS-Programs graphically</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#Actuated_Traffic_Lights"><span class="tocnumber">2.5</span> <span class="toctext">Actuated Traffic Lights</span></a>
<ul>
<li class="toclevel-3 tocsection-14"><a href="#Based_on_Time_Gaps"><span class="tocnumber">2.5.1</span> <span class="toctext">Based on Time Gaps</span></a></li>
<li class="toclevel-3 tocsection-15"><a href="#Based_on_Time_Loss"><span class="tocnumber">2.5.2</span> <span class="toctext">Based on Time Loss</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-16"><a href="#Interaction_between_signal_plans_and_right-of-way_rules"><span class="tocnumber">2.6</span> <span class="toctext">Interaction between signal plans and right-of-way rules</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-17"><a href="#Loading_a_new_Program"><span class="tocnumber">3</span> <span class="toctext">Loading a new Program</span></a></li>
<li class="toclevel-1 tocsection-18"><a href="#Tools_for_Importing_TLS_Programs"><span class="tocnumber">4</span> <span class="toctext">Tools for Importing TLS Programs</span></a></li>
<li class="toclevel-1 tocsection-19"><a href="#Modifying_Existing_TLS-Programs"><span class="tocnumber">5</span> <span class="toctext">Modifying Existing TLS-Programs</span></a></li>
<li class="toclevel-1 tocsection-20"><a href="#Controlling_multiple_Junctions_with_the_same_controller"><span class="tocnumber">6</span> <span class="toctext">Controlling multiple Junctions with the same controller</span></a></li>
<li class="toclevel-1 tocsection-21"><a href="#Defining_Signal_Groups"><span class="tocnumber">7</span> <span class="toctext">Defining Signal Groups</span></a></li>
<li class="toclevel-1 tocsection-22"><a href="#Defining_Program_Switch_Times_and_Procedure"><span class="tocnumber">8</span> <span class="toctext">Defining Program Switch Times and Procedure</span></a></li>
<li class="toclevel-1 tocsection-23"><a href="#Evaluation_of_Traffic_Lights_Performance"><span class="tocnumber">9</span> <span class="toctext">Evaluation of Traffic Lights Performance</span></a>
<ul>
<li class="toclevel-2 tocsection-24"><a href="#Tools_For_Automatic_Detector_Generation"><span class="tocnumber">9.1</span> <span class="toctext">Tools For Automatic Detector Generation</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-25"><a href="#Controlling_traffic_lights_via_TraCI"><span class="tocnumber">10</span> <span class="toctext">Controlling traffic lights via TraCI</span></a>
<ul>
<li class="toclevel-2 tocsection-26"><a href="#Setting_the_phase"><span class="tocnumber">10.1</span> <span class="toctext">Setting the phase</span></a></li>
<li class="toclevel-2 tocsection-27"><a href="#Setting_the_duration"><span class="tocnumber">10.2</span> <span class="toctext">Setting the duration</span></a></li>
<li class="toclevel-2 tocsection-28"><a href="#Setting_the_state"><span class="tocnumber">10.3</span> <span class="toctext">Setting the state</span></a></li>
<li class="toclevel-2 tocsection-29"><a href="#Setting_the_complete_Program"><span class="tocnumber">10.4</span> <span class="toctext">Setting the complete Program</span></a></li>
<li class="toclevel-2 tocsection-30"><a href="#Switching_between_pre-defined_Programs"><span class="tocnumber">10.5</span> <span class="toctext">Switching between pre-defined Programs</span></a></li>
</ul>
</li>
</ul>
</div>

<h1><span class="mw-headline" id="Automatically_Generated_TLS-Programs">Automatically Generated TLS-Programs</span></h1>
<ul><li>All traffic lights are generated with a fixed cycle and a default cycle time of 90s. This can be changed with the option <span style="color: #111144; font-weight: bold; white-space: pre;">--tls.cycle.time</span>.</li>
<li>All green phases are followed by a yellow phase. The length of the yellow phase is computed from the maximum speed of the incoming roads but may be customized with the option <span style="color: #111144; font-weight: bold; white-space: pre;">--tls.yellow.time</span></li>
<li>If the speeds at the intersection are below the threshold of 70km/h (configurable via option <span style="color: #111144; font-weight: bold; white-space: pre;">tls.minor-left.max-speed</span>), left-turns are allowed at the same time as oncoming straight traffic but have to yield. This is called <i>green minor</i> and indicated with a lower-case <b>g</b> in the state definition. Otherwise, the left-turning stream must use a protected left-turn phase (see below). If no such phase can be built because there is no dedicated turning lane, <i>green minor</i> is allowed anyway but a warning is issued.</li>
<li>If a green phase allows for partially conflicting streams (i.e. straight going and left-turning from the opposite direction) and there is a dedicated turning lane, it is succeeded by another green phase with full priority to the partially conflicted streams (this would typically be a left-turning phase). The duration of this phase defaults to 6s and can be customized (or disabled) by setting the option <span style="color: #111144; font-weight: bold; white-space: pre;">--tls.left-green.time</span>.</li>
<li>In reality there are often phases where all streams have red to allow clearing an intersection. SUMO does not build these phases by default. To have each green phase preceded by an all-red phase, the option <span style="color: #111144; font-weight: bold; white-space: pre;">--tls.allred.time</span> can be used.</li>
<li>It is also possible to generate <a href="#Actuated_Traffic_Lights">#Actuated_Traffic_Lights</a> by setting the option <span style="color: #111144; font-weight: bold; white-space: pre;">--tls.default-type actuated</span>. This will generated the same signal plans as above but with green phases that have a variable length of 5s-50s (both values can be set using the options <span style="color: #111144; font-weight: bold; white-space: pre;">--tls.min-dur, --tls.max-dur</span>).</li>
<li>The generated phase layout can be selected setting option <span style="color: #111144; font-weight: bold; white-space: pre;">--tls.layout</span> to <i>opposites</i> (default) or <i>incoming</i>.</li>
<li>The generated phase layout is also influenced by the <a href="../Networks/PlainXML.html#Node_types" title="Networks/PlainXML">node type</a> which may be either <i>traffic_light</i> or <i>traffic_light_right_on_red</i> (explained below)</li></ul>
<h2><span id="Default_4-arm_intersection_(layout_opposites)"></span><span class="mw-headline" id="Default_4-arm_intersection_.28layout_opposites.29">Default 4-arm intersection (layout <i>opposites</i>)</span></h2>
<p>By default, programs are generated with 4 green phases:
</p>
<ol><li>a straight phase</li>
<li>a left-turning phase (only if there is a dedicated left-turn lane)</li>
<li>a straight phase for the direction orthogonal to the first one</li>
<li>a left-turning phase for the direction direction orthogonal to the first one (only if there is a dedicated left-turn lane)</li></ol>
<p>Due to the default timings explained above, the green phases usually have a duration of 31s.
</p><p>If the node type is set to <i>traffic_light_right_on_red</i> rather than <i>traffic_light</i>, then right turns from all sides are permitted in all phases (after coming to a stop before entering the traffic stream that currently has the green light.
</p>
<h2><span class="mw-headline" id="Intersection_layout_incoming">Intersection layout <i>incoming</i></span></h2>
<ul><li>each incoming edge of the intersection gets a separate green phase where all directions of movement are allowed</li>
<li>If the node type is set to <i>traffic_light_right_on_red</i> rather than <i>traffic_light</i>, then compatible right-turns are allowed simultaneously</li></ul>
<h2><span class="mw-headline" id="Other_Intersections">Other Intersections</span></h2>
<ul><li>If there are more than 4 roads meeting at an intersection, additional green phases are generated</li>
<li>If the roads meeting at an intersection have the highest road priorities on a turning stream, then layout <i>incoming</i> may be generated instead of layout <i>opposites</i>.</li>
<li>If a traffic-light junction does not have any conflicting roads (i.e. it models a pedestrian crossing) it will not get a red phase by default. A single red phase may be generated by setting the option <span style="color: #111144; font-weight: bold; white-space: pre;">--tls.red.time</span>.</li></ul>
<h2><span class="mw-headline" id="Improving_Generated_programs_with_knowledge_about_traffic_demand">Improving Generated programs with knowledge about traffic demand</span></h2>
<ul><li>To get traffic lights that adapt to demand dynamically, built the network with option <span style="color: #111144; font-weight: bold; white-space: pre;">--tls.default-type actuated</span>. This will automatically generate <a href="#Actuated_Traffic_Lights">actuated traffic lights</a>. To convert an existing .net.xml file so that all traffic lights are actuated, perform the following steps:
<ul><li>netconvert -s orig.net.xml --plain-output-prefix plain</li>
<li>netconvert -e plain.edg.xml -n plain.nod.xml -x plain.con.xml -o updated.net.xml --ignore-errors.edge-type --tls.default-type actuated</li></ul></li>
<li>The tool <a href="../Tools/tls.html#tlsCycleAdaptation.py" title="Tools/tls">tlsCycleAdaptation.py</a> can be used to modify green phase durations to accommodate a given traffic demand.</li>
<li>The tool <a href="../Tools/tls.html#tlsCoordinator.py" title="Tools/tls">tlsCoordinator.py</a> can be used to modify program offsets to generated green waves for  a given traffic demand.</li></ul>
<h1><span class="mw-headline" id="Defining_New_TLS-Programs">Defining New TLS-Programs</span></h1>
<p>You can load new definitions for traffic lights as a part of an <a href="../SUMO.html#Format_of_additional_files" title="SUMO"><i>additional-file</i></a>. When loaded, the last program will be used. Switching between programs is possible via WAUTs and/or TraCI. Also, one can switch between them using the GUI context menu. A definition of a traffic light program within an <a href="../SUMO.html#Format_of_additional_files" title="SUMO"><i>additional-file</i></a> looks like this:
</p>
<pre class="xml">&lt;additional&gt;
   &lt;tlLogic id="0" programID="my_program" offset="0" type="static"&gt;
      &lt;phase duration="31" state="GGggrrrrGGggrrrr"/&gt;
      &lt;phase duration="5"  state="yyggrrrryyggrrrr"/&gt;
      &lt;phase duration="6"  state="rrGGrrrrrrGGrrrr"/&gt;
      &lt;phase duration="5"  state="rryyrrrrrryyrrrr"/&gt;
      &lt;phase duration="31" state="rrrrGGggrrrrGGgg"/&gt;
      &lt;phase duration="5"  state="rrrryyggrrrryygg"/&gt;
      &lt;phase duration="6"  state="rrrrrrGGrrrrrrGG"/&gt;
      &lt;phase duration="5"  state="rrrrrryyrrrrrryy"/&gt;
   &lt;/tlLogic&gt;
&lt;/additional&gt;
</pre>
<p><br />
</p>
<div style="background: #ffffdd; padding: .5em; border: 1px dashed #ffcc44; margin-right:10px; margin-left:10px;"><b>Note:</b><br />To get started you can copy the <b>tlLogic</b> elements for all traffic lights you wish to edit from a .net.xml file and put them into a new file. Then you only need to change the programID attribute and the program is ready to be modified and loaded</div>
<p><br />
</p>
<h2><span id="&lt;tlLogic&gt;_Attributes"></span><span class="mw-headline" id=".3CtlLogic.3E_Attributes">&lt;tlLogic&gt; Attributes</span></h2>
<p>The following attributes/elements are used within the tlLogic element:
</p>
<table cellspacing="0" border="1" align="center" width="80%">

<tbody><tr>
<th style="background:#ddddff;">Attribute Name
</th>
<th style="background:#ddddff;">Value Type
</th>
<th style="background:#ddddff;">Description
</th></tr>
<tr>
<td class="inlxml"><b>id</b>
</td>
<td>id (string)
</td>
<td>The id of the traffic light. This must be an existing traffic light id in the .net.xml file. Typically the id for a traffic light is identical with the junction id. The name may be obtained by right-clicking the red/green bars in front of a controlled intersection.
</td></tr>
<tr>
<td class="inlxml"><b>type</b>
</td>
<td>enum (static, actuated, delay_based)
</td>
<td>The type of the traffic light (fixed phase durations, phase prolongation based on time gaps between vehicles (actuated), or on accumulated time loss of queued vehicles (delay_based) )
</td></tr>
<tr>
<td class="inlxml"><b>programID</b>
</td>
<td>id (string)
</td>
<td>The id of the traffic light program; This must be a new program name for the traffic light id. Please note that "off" is reserved, see below.
</td></tr>
<tr>
<td class="inlxml"><b>offset</b>
</td>
<td>int
</td>
<td>The initial time offset of the program
</td></tr>
</tbody></table>
<h2><span id="&lt;phase&gt;_Attributes"></span><span class="mw-headline" id=".3Cphase.3E_Attributes">&lt;phase&gt; Attributes</span></h2>
<p>Each phase is defined using the following attributes:
</p>
<table cellspacing="0" border="1" align="center" width="80%">

<tbody><tr>
<th style="background:#ddddff;">Attribute Name
</th>
<th style="background:#ddddff;">Value Type
</th>
<th style="background:#ddddff;">Description
</th></tr>
<tr>
<td class="inlxml"><b>duration</b>
</td>
<td>time (int)
</td>
<td>The duration of the phase
</td></tr>
<tr>
<td class="inlxml"><b>state</b>
</td>
<td>list of signal states
</td>
<td>The traffic light states for this phase, see below
</td></tr>
<tr>
<td class="inlxml">minDur
</td>
<td>time (int)
</td>
<td>The minimum duration of the phase when using type <b>actuated</b>. Optional, defaults to duration.
</td></tr>
<tr>
<td class="inlxml">maxDur
</td>
<td>time (int)
</td>
<td>The maximum duration of the phase when using type <b>actuated</b>. Optional, defaults to duration.
</td></tr>
<tr>
<td class="inlxml">name
</td>
<td>string
</td>
<td>An optional description for the phase. This can be used to establish the correspondence between SUMO-phase-indexing and traffic engineering phase names.
</td></tr>
<tr>
<td class="inlxml">next
</td>
<td>index (int)
</td>
<td>The next phase in the cycle after the current. This is useful when adding extra transition phases to a traffic light plan which are not part of every cycle.
</td></tr>
</tbody></table>
<div style="background: #ffcc44; padding: .5em; border: 1px dashed #ff8800; margin-right:10px; margin-left:10px;"><b>Caution:</b><br />In a SUMO-TLS definition, time is on the vertical axis and each phase describes all signal states that last for a fixed duration. This differs from typical traffic engineering diagrams where time is on the horizontal axis and each row describes the states for one signal. Another crucial difference is, that in SUMO a new phase is introduced whenever at least one signal changes its state. This means that transitions between green phases can be made up of multiple intermediate phases.</div>
<h2><span class="mw-headline" id="Signal_state_definitions">Signal state definitions</span></h2>
<p>Each character within a phase's state describes the state of one signal of the traffic light. Please note, that a single lane may contain several signals - for example one for vehicles turning left and one for vehicles which move straight. This means that a signal does not control lanes, but links - each connecting a lane which is incoming into a junction and one which is outgoing from this junction. In SUMO, a one-to-n dependency between signals and links is implemented, this means each signal may control more than a single link - though networks generated by <a href="../NETCONVERT.html" title="NETCONVERT">NETCONVERT</a> or <a href="../NETGENERATE.html" title="NETGENERATE">NETGENERATE</a> usually use one signal per link. Please note also, that a traffic light may control lanes incoming into different junctions. The information about which link is controlled by which traffic light signal may be obtained using the "show link tls index" option within <a href="../SUMO-GUI.html" title="SUMO-GUI">SUMO-GUI</a>'s visualisation settings or from the according <span class="inlxml">linkIndex</span> attribute of the <span class="inlxml">&lt;connection&gt;</span> elements in the <i>.net.xml</i> file.
</p><p>The following signal colors are used:
</p>
<table cellspacing="0" border="1" align="center" width="80%">

<tbody><tr>
<th style="background:#ddddff;">Character
</th>
<th style="background:#ddddff;">GUI Color
</th>
<th style="background:#ddddff;">Description
</th></tr>
<tr>
<td class="inlxml">r
</td>
<td><span style="color:#FF0000; background:#FF0000">FOO</span>
</td>
<td>'red light' for a signal - vehicles must stop
</td></tr>
<tr>
<td class="inlxml">y
</td>
<td><span style="color:#FFFF00; background:#FFFF00">FOO</span>
</td>
<td>'amber (yellow) light' for a signal - vehicles will start to decelerate if far away from the junction, otherwise they pass
</td></tr>
<tr>
<td class="inlxml">g
</td>
<td><span style="color:#00B300; background:#00B300">FOO</span>
</td>
<td>'green light' for a signal, no priority - vehicles may pass the junction if no vehicle uses a higher priorised foe stream, otherwise they decelerate for letting it pass. They always decelerate on approach until they are within the configured <a href="../Networks/Building_Networks_from_own_XML-descriptions.html#Explicitly_setting_which_Edge_.2F_Lane_is_connected_to_which" class="mw-redirect" title="Networks/Building Networks from own XML-descriptions">visibility distance</a>
</td></tr>
<tr>
<td class="inlxml">G
</td>
<td><span style="color:#00FF00; background:#00FF00">FOO</span>
</td>
<td>'green light' for a signal, priority - vehicles may pass the junction
</td></tr>
<tr>
<td class="inlxml">s
</td>
<td><span style="color:#800080; background:#800080">FOO</span>
</td>
<td>'green right-turn arrow' requires stopping - vehicles may pass the junction if no vehicle uses a higher priorised foe stream. They always stop before passing. This is only generated for junction type <i>traffic_light_right_on_red</i>.
</td></tr>
<tr>
<td class="inlxml">u
</td>
<td><span style="color:#FF8000; background:#FF8000">FOO</span>
</td>
<td>'red+yellow light' for a signal, may be used to indicate upcoming green phase but vehicles may not drive yet (shown as orange in the gui)
</td></tr>
<tr>
<td class="inlxml">o
</td>
<td><span style="color:#804000; background:#804000">FOO</span>
</td>
<td>'off - blinking' signal is switched off, blinking light indicates vehicles have to yield
</td></tr>
<tr>
<td class="inlxml">O
</td>
<td><span style="color:#00FFFF; background:#00FFFF">FOO</span>
</td>
<td>'off - no signal' signal is switched off, vehicles have the right of way
</td></tr>
</tbody></table>
<p><br />
</p>
<div class="floatleft"><a href="../images/Traci_tutorial_tls.png" class="image"><img alt="Traci tutorial tls.png" src="../images/Traci_tutorial_tls.png" width="400" height="389" srcset="/w/images/thumb/1/14/Traci_tutorial_tls.png/600px-Traci_tutorial_tls.png 1.5x, /w/images/thumb/1/14/Traci_tutorial_tls.png/800px-Traci_tutorial_tls.png 2x" /></a></div><p>Example: traffic light with the current state <b>"GrGr"</b>. The leftmost letter "G" encodes the green light for link 0, followed by red for link 1, green for link 2 and red for link 3. The link numbers are enabled via <a href="../SUMO-GUI.html" title="SUMO-GUI">SUMO-GUI settings</a> by activating <i>show link tls index</i>.
</p><p><br style="clear:both" />
</p>
<h3><span class="mw-headline" id="Default_link_indices">Default link indices</span></h3>
<p>For traffic lights that control a single intersection, the default <a href="../Networks/SUMO_Road_Networks.html#Indices_of_a_connection" title="Networks/SUMO Road Networks">indices generated generated by NETCONVERT</a>  are numbered in a clockwise pattern starting with 0 at 12 o'clock with right-turns ordered before straight connections and left turns.
<a href="../Networks/PlainXML.html#Pedestrian_Crossings" title="Networks/PlainXML">Pedestrian crossings</a> are always assigned at the very end, also in a clockwise manner.
</p><p>If traffic lights are joined so that a single program controls multiple intersections, the ordering for each intersection stays the same but the indices are increased according the order of the controlled junctions in the input file.
</p>
<h3><span class="mw-headline" id="Accessing_indices_programmatically">Accessing indices programmatically</span></h3>
<p>TLS Link indices can be access using either 
</p>
<ul><li><a href="../Tools/Sumolib.html" title="Tools/Sumolib">sumolib</a> using <a rel="nofollow" class="external text" href="../../pydoc/sumolib.net.html#TLS">tls.getConnections()</a></li>
<li>or <a href="../TraCI.html" title="TraCI">TraCI</a> using <a href="../TraCI/Traffic_Lights_Value_Retrieval.html#Structure_of_compound_object_controlled_links" title="TraCI/Traffic Lights Value Retrieval">traci.trafficlight.getControlledLinks()</a></li></ul>
<h2><span class="mw-headline" id="Viewing_TLS-Programs_graphically">Viewing TLS-Programs graphically</span></h2>
<p>In the sumo-gui you can click on a red/green stop bar and select show phases.
</p>
<h2><span class="mw-headline" id="Actuated_Traffic_Lights">Actuated Traffic Lights</span></h2>
<h3><span class="mw-headline" id="Based_on_Time_Gaps">Based on Time Gaps</span></h3>
<p>SUMO supports <i>gap-based</i> actuated traffic control This control scheme is common in Germany and works by prolonging traffic phases whenever a continuous stream of traffic is detected. It switches to the next phase after detecting a sufficient time gap between sucessive vehicles. This allows for better distribution of green-time among phases and also affects cycle duration in response to dynamic traffic conditions.
</p><p>To use this type of control, the <span class="inlxml">&lt;tlLogic&gt;</span>-element needs to receive the attribute <span class="inlxml">type="actuated"</span>. It also requires the usage of the <span class="inlxml">phase</span>-attributes <span class="inlxml">minDur</span> and <span class="inlxml">maxDur</span> instead of <span class="inlxml">duration</span> to define the allowed range of time durations for each phase (if these values are equal or only <span class="inlxml">duration</span> is given, that phase will have constant duration). Additional parameters may be used to configure the control algorithm further. These may be given within the <span class="inlxml">&lt;tlLogic&gt;</span>-Element as follows:
</p>
<pre class="xml">&lt;tlLogic id="0" programID="my_program" offset="0" type="actuated"&gt;
   &lt;param key="max-gap" value="3.0"/&gt;
   &lt;param key="detector-gap" value="2.0"/&gt;
   &lt;param key="show-detectors" value="false"/&gt;
   &lt;param key="file" value="NULL"/&gt;
   &lt;param key="freq" value="300"/&gt;

   &lt;phase duration="31" minDur="5" maxDur="45" state="GGggrrrrGGggrrrr"/&gt;
   ...
&lt;/tlLogic&gt;
</pre>
<p>The value of <b>max-gap</b> describes the maximum time gap between successive vehicle that will cause the current phase to be prolonged (within limits). <b>detector-gap</b> determines the time distance between the (automatially generated) detector and the stop line in seconds (at each lanes maximum speed). If <b>show-detectors</b> is set to <i>true</i>, the generated detectors are shown in <a href="../SUMO-GUI.html" title="SUMO-GUI">SUMO-GUI</a>. The parameters <b>file</b> and <b>freq</b> have the same meaning as for <a href="../Simulation/Output/Induction_Loops_Detectors_(E1).html" title="Simulation/Output/Induction Loops Detectors (E1)">regular induction loop detectors</a>.
The examples values are the default values for these parameters.
</p>
<h3><span class="mw-headline" id="Based_on_Time_Loss">Based on Time Loss</span></h3>
<p>Similar to the control by time gaps between vehicles, a phase prolongation can also be triggered by the presence of vehicles with time loss. A TLS with this actuation type can be defined as follows: 
</p>
<pre class="xml">&lt;tlLogic id="0" programID="my_program" offset="0" type="delay_based"&gt;
   &lt;param key="detectorRange" value="100" /&gt;
   &lt;param key="minTimeLoss" value="1" /&gt;
   &lt;param key="file" value="NULL"/&gt;
   &lt;param key="freq" value="300"/&gt;
   &lt;param key="show-detectors" value="false"/&gt;
   
   &lt;phase duration="31" minDur="5" maxDur="45" state="GGggrrrrGGggrrrr"/&gt;
   ...
&lt;/tlLogic&gt;
</pre>  
<p>Here, the <span class="inlxml">detectorRange</span> specifies the upstream detection range in meters measured from the stop line. Per default (if the parameter is left undefined) the underlying <a href="../Simulation/Output/Lanearea_Detectors_(E2).html" title="Simulation/Output/Lanearea Detectors (E2)">E2 detector</a> is assumed to cover the first approaching lanes completely. The time loss for a vehicle is accumulated as soon as it enters the detector range. If its accumulated time loss exceeds the value of <span class="inlxml">minTimeLoss</span> (current default is one second) seconds a prolongation of the corresponding green phase is requested if it is active.
The instantaneous time loss of a vehicle is defined as <code>1 - v/v_max</code>, where <code>v</code> is its current velocity and <code>v_max</code> the allowed maximal velocity. See [Oertel, Robert, and Peter Wagner. "Delay-time actuated traffic signal control for an isolated intersection." Transportation Research Board 2011 (90th Annual Meeting). 2011.] for details.
</p>
<h2><span class="mw-headline" id="Interaction_between_signal_plans_and_right-of-way_rules">Interaction between signal plans and right-of-way rules</span></h2>
<p>Every traffic light intersection has the right-of-way rules of a priority intersection underneath of it. This becomes obvious when switching a traffic light off (either in <a href="../SUMO-GUI.html" title="SUMO-GUI">SUMO-GUI</a> with a right-click on the traffic light or by <a href="#Loading_a_new_Program">loading the "off" program</a>).
</p><p>The right-of-way rules of this priority intersection come into play when defining signal plans with  simultaneous conflicting green streams (by using <i>g</i> and <i>G</i> states). These signal plans only work correctly if the right-of-way rules force vehicles from the <i>g</i> stream to yield to the <i>G</i> stream. In most cases, this relationship was set correctly by the default signal plan.
</p><p>However, when introducing new <i>g</i>/<i>G</i> relationships, correctness is only ensured by loading the network and the new signal plan into <a href="../NETCONVERT.html" title="NETCONVERT">NETCONVERT</a> and thus updating the right-of-way rules.
</p>
<h1><span class="mw-headline" id="Loading_a_new_Program">Loading a new Program</span></h1>
<p>After having defined a tls program as above, it can be loaded as an <a href="../SUMO.html#Format_of_additional_files" title="SUMO"><i>additional-file</i></a>; of course, a single <a href="../SUMO.html#Format_of_additional_files" title="SUMO"><i>additional-file</i></a> may contain several programs. It is possible to load several programs for a single tls into the simulation. The program loaded last will be used (unless not defined differently using a WAUT description). All subkeys of the additional programs must differ if they describe the same tls.
</p><p>Assuming the program as defined above is put in a file called <i>tls.add.xml</i> it can be loaded in <a href="../SUMO.html" title="SUMO">SUMO</a>/<a href="../SUMO-GUI.html" title="SUMO-GUI">SUMO-GUI</a> like this
</p>
<pre> sumo -a tls.add.xml ...&lt;other options for network and routes&gt;
</pre>
<p>It is also possible to load a program which switches the tls off by giving the <span class="inlxml">programID</span> the value "<span class="inlxml">off</span>". 
</p>
<pre class="xml">&lt;tlLogic id="0" type="static" programID="off"/&gt;
</pre>
<p><br />
</p>
<h1><span class="mw-headline" id="Tools_for_Importing_TLS_Programs">Tools for Importing TLS Programs</span></h1>
<p>Description from real-world traffic light systems do not arrive in form of SUMO-traffic light descriptions normally. 
The main difference in presentation comes from the fact that SUMO defines a new <span class="inlxml">&lt;phase&gt;</span> whenever any of the controlled signals changes its state, whereas traffic engineers differentiate between phases and phase transitions.
</p><p>For an easier import than editing the XML by hand, some tools exists in  <i><b>&lt;SUMO_HOME&gt;</b></i>/tools/tls.
</p>
<ul><li><a href="../Tools/tls.html#tls_csv2SUMO.py" title="Tools/tls">tls_csv2SUMO.py</a>: this tool simplifies descriptions because it allows to define the duration of phases for each controlled edge-to-edge connection. Splitting into smaller SUMO-phases because other signals change is done automatically.</li>
<li><a href="../Tools/tls.html#tls_csvSignalGroup.py" title="Tools/tls">tls_csvSignalGroup.py</a>: this tool further simplifies descriptions because it allows to define the start and end times of green-phases per signal group (up to 2 green phases, actually) and the transitions (yellow, red-yellow) are added automatically. The splitting into smaller SUMO-phases is also done automatically.</li></ul>
<p>Alternatively <a href="../NETEDIT.html" title="NETEDIT">NETEDIT</a> can be used to edit programs using a graphical user interface.
</p>
<h1><span class="mw-headline" id="Modifying_Existing_TLS-Programs">Modifying Existing TLS-Programs</span></h1>
<p>To modify the program of a traffic light it is generally necessary to <a href="#Loading_New_TLS-Programs">load a new program</a>. However, in the special case that only the offset shall be modified it is also possible to specify a new offset for an existing traffic light id and programID:
</p>
<pre class="xml">&lt;additional&gt;
   &lt;tlLogic id="0" programID="0" offset="42"/&gt;
&lt;/additional&gt;
</pre>
<h1><span class="mw-headline" id="Controlling_multiple_Junctions_with_the_same_controller">Controlling multiple Junctions with the same controller</span></h1>
<p>In SUMO, a traffic light controller can controll an arbitary number of junctions simultaneously. 
This is accomplished by one of the following methods:
</p>
<ul><li>Defining the same <i>tl</i> attribute (the controller ID) for a set of nodes in <i>.nod.xml</i> file when building the network with <a href="../NETCONVERT.html" title="NETCONVERT">NETCONVERT</a></li>
<li>Setting the same <i>tl</i> attribute for multiple nodes in <a href="../NETEDIT.html" title="NETEDIT">NETEDIT</a></li>
<li>Setting the option <span style="color: #111144; font-weight: bold; white-space: pre;">--tls.join</span> when building the network with <a href="../NETCONVERT.html" title="NETCONVERT">NETCONVERT</a>. This will automatically join the traffic lights of nodes in close proximity within a default distance of 20m (customizable by setting option <span style="color: #111144; font-weight: bold; white-space: pre;">tls.join-dist <a href="../Basics/Notation.html#Referenced_Data_Types" title="Basics/Notation"><i>&lt;FLOAT&gt;</i></a></span>).</li></ul>
<p>Note, that in this case the state vector for each phase will be as long as the total number of controlled intersections. Also, the tls indices for the connections will differ from the link indices (as the latter starts with 0 for each intersection whereas the tls indices are unique within a controller).
</p>
<div style="background: #ffcc44; padding: .5em; border: 1px dashed #ff8800; margin-right:10px; margin-left:10px;"><b>Caution:</b><br />The generated TLS program will attempt to identify the main directions but usually this needs some manual corrections.</div>
<h1><span class="mw-headline" id="Defining_Signal_Groups">Defining Signal Groups</span></h1>
<p>In SUMO every lane-to-lane connection at a controlled intersection is assigned an index called <i>link tls index</i>. This index is used to determine the state for each phase by looking up the character code at that index in the state vector.
The link index can be shown in <a href="../SUMO-GUI.html" title="SUMO-GUI">SUMO-GUI</a> by setting the junction visualization option <i>show link tls index</i>.
By default link indices are unique for each connection and assigned in a clockwise manner starting at the north (the same as the junction link index which is used for defining right-of-way rules). When <a href="#Controlling_multiple_Junctions_with_the_same_controller">defining joint TLS</a>, the indices continue their numbering in the order of the controlled junctions.
</p><p>The tls index for each connection can be <a href="../Networks/Building_Networks_from_own_XML-descriptions.html#controlled_connections" class="mw-redirect" title="Networks/Building Networks from own XML-descriptions">freely assigned in a <i>.tll.file</i></a> or by setting attribute <i>linkIndex</i> in <a href="../NETEDIT.html" title="NETEDIT">NETEDIT</a>. By assigning the <b>same</b> index to multiple connection they form a signal group and always show the same state (simply because they reference the same state index). This allows shortening and thus simplifying the state vector.
</p>
<h1><span class="mw-headline" id="Defining_Program_Switch_Times_and_Procedure">Defining Program Switch Times and Procedure</span></h1>
<p>In practice, a tls often uses different programs during a day and maybe also for weekdays and for the weekend days. It is possible to load a definition of switch times between the programs using a WAUT (short for "Wochenschaltautomatik" ~ weekly switch automatism).
</p><p>Given a tls which knows four programs - two for weekdays and two for weekend days where from 22:00 till 6:00 the night plan shall be used and from 6:00 till 22:00 the day plan, and already defined programs, named "weekday_night", "weekday_day", "weekend_night", "weekend_day". To describe the switch process, we have to describe the switch at first, assuming our simulation runs from monday 0.00 (second 0) to monday 0.00 (second 604800):
</p>
<pre class="xml">&lt;WAUT refTime="0" id="myWAUT" startProg="weekday_night"&gt;
   &lt;wautSwitch time="21600" to="weekday_day"/&gt;    &lt;!-- monday, 6.00 --&gt;
   &lt;wautSwitch time="79200" to="weekday_night"/&gt;  &lt;!-- monday, 22.00 --&gt;
   &lt;wautSwitch time="108000" to="weekday_day"/&gt;   &lt;!-- tuesday, 6.00 --&gt;
... further weekdays ...
   &lt;wautSwitch time="453600" to="weekend_day"/&gt;   &lt;!-- saturday, 6.00 --&gt;
... the weekend days ...
&lt;/WAUT&gt;
</pre>
<p><br />
The fields in WAUT have the following meanings:
</p>
<table cellspacing="0" border="1" align="center" width="80%">

<tbody><tr>
<th style="background:#ddddff;">Attribute Name
</th>
<th style="background:#ddddff;">Value Type
</th>
<th style="background:#ddddff;">Description
</th></tr>
<tr>
<td class="inlxml"><b>id</b>
</td>
<td>string id
</td>
<td>The name of the defined WAUT
</td></tr>
<tr>
<td class="inlxml"><b>refTime</b>
</td>
<td>int
</td>
<td>A reference time which is used as offset to the switch times given later (in simulation seconds)
</td></tr>
<tr>
<td class="inlxml"><b>startProg</b>
</td>
<td>string id
</td>
<td>The program that will be used at the simulation's begin
</td></tr></tbody></table>
<p>and the fields in wautSwitch:
</p>
<table cellspacing="0" border="1" align="center" width="80%">

<tbody><tr>
<th style="background:#ddddff;">Attribute Name
</th>
<th style="background:#ddddff;">Value Type
</th>
<th style="background:#ddddff;">Description
</th></tr>
<tr>
<td class="inlxml"><b>time</b>
</td>
<td>int
</td>
<td>The time the switch will take place
</td></tr>
<tr>
<td class="inlxml"><b>to</b>
</td>
<td>string id
</td>
<td>The name of the program the assigned tls shall switch to
</td></tr></tbody></table>
<p>Of course, programs with the used names must be defined before this definition is read. Also, the switch steps must be sorted by their execution time.
</p><p>Additionally, a definition about which tls shall be switched by the WAUT must be given, as following:
</p>
<pre class="xml">&lt;wautJunction wautID="myWAUT" junctionID="RCAS" [procedure="Stretch"] [synchron="t"]/&gt;
</pre>
<p>Here, the attributes have the following meaning:
</p>
<table cellspacing="0" border="1" align="center" width="80%">

<tbody><tr>
<th style="background:#ddddff;">Attribute Name
</th>
<th style="background:#ddddff;">Value Type
</th>
<th style="background:#ddddff;">Description
</th></tr>
<tr>
<td class="inlxml"><b>wautID</b>
</td>
<td>string id
</td>
<td>The id of the WAUT the tls shall be switched by
</td></tr>
<tr>
<td class="inlxml"><b>junctionID</b>
</td>
<td>string id
</td>
<td>The name of the tls to assign to the WAUT
</td></tr>
<tr>
<td class="inlxml"><b>procedure</b>
</td>
<td>string enum
</td>
<td>The switching algorithm to use ("GSP" or "Stretch"). If not set, the programs will switch immediately (default)
</td></tr>
<tr>
<td class="inlxml"><b>synchron</b>
</td>
<td>bool
</td>
<td>Additional information whether the switch shall be done synchron (default: false)
</td></tr></tbody></table>
<p>It is possible to assign several tls to a single WAUT. It is also possible to assign several WAUTs to a single junction in theory, but this is not done in reality.
</p><p>A complete definition within an <a href="../SUMO.html#Format_of_additional_files" title="SUMO"><i>additional-file</i></a> is shown below. It would
trigger switching between programs <b>S1</b> and <b>S2</b> for traffic light logic <b>X</b> with an initial program called <b>0</b>.
</p>
<pre class="xml">&lt;additional&gt;

  &lt;tlLogic id="X" type="static" programID="S1" offset="0"&gt;
    &lt;phase duration="50" state="Gr"/&gt;
    &lt;phase duration="50" state="rG"/&gt;
  &lt;/tlLogic&gt;
  
  &lt;tlLogic id="X" type="static" programID="S2" offset="0"&gt;
    &lt;phase duration="30" state="Gr"/&gt;
    &lt;phase duration="80" state="rG"/&gt;
  &lt;/tlLogic&gt;


  &lt;WAUT startProg="0" refTime="100" id="w1"&gt;
    &lt;wautSwitch to="S1" time="300"&gt;&lt;/wautSwitch&gt;
    &lt;wautSwitch to="SS" time="800"&gt;&lt;/wautSwitch&gt;
  &lt;/WAUT&gt;

  &lt;wautJunction junctionID="X" wautID="w1"&gt;&lt;/wautJunction&gt;

&lt;additional&gt;
</pre>
<h1><span class="mw-headline" id="Evaluation_of_Traffic_Lights_Performance">Evaluation of Traffic Lights Performance</span></h1>
<h2><span class="mw-headline" id="Tools_For_Automatic_Detector_Generation">Tools For Automatic Detector Generation</span></h2>
<p>Some tools are available which help generating detector definitions for the evaluation of traffic lights. All are located in <i><b>&lt;SUMO_HOME&gt;</b></i>/tools/output.
</p>
<div style="background: #ffffdd; padding: .5em; border: 1px dashed #ffcc44; margin-right:10px; margin-left:10px;"><b>Note:</b><br />The actuated traffic lights do not require detector definitions to be added as they generate their own detectors for internal use.</div>
<ul><li><i><b>generateTLSE2Detectors.py</b></i> generates a file which includes areal detectors. All lanes incoming into an intersection are covered with these detectors. The offset from the intersection may be given using the option <span style="color: #111144; font-weight: bold; white-space: pre;">--distance-to-TLS <a href="../Basics/Notation.html#Referenced_Data_Types" title="Basics/Notation"><i>&lt;FLOAT&gt;</i></a></span> (or <span style="color: #111144; font-weight: bold; white-space: pre;">-d <a href="../Basics/Notation.html#Referenced_Data_Types" title="Basics/Notation"><i>&lt;FLOAT&gt;</i></a></span>), the default is .1m. The generated detectors end either after a given length, defined using <span style="color: #111144; font-weight: bold; white-space: pre;">--detector-length <a href="../Basics/Notation.html#Referenced_Data_Types" title="Basics/Notation"><i>&lt;FLOAT&gt;</i></a></span> (or <span style="color: #111144; font-weight: bold; white-space: pre;">-l <a href="../Basics/Notation.html#Referenced_Data_Types" title="Basics/Notation"><i>&lt;FLOAT&gt;</i></a></span>) where the default is 250m, or at the lane's end if the lane is shorter than this length.</li>
<li><i><b>generateTLSE3Detectors.py</b></i> generates a file which includes multi-entry/multi-exit detectors. Detectors are built for each edge incoming to the traffic light. All lanes of each of these edges are covered with exit points. These point's offset from the intersection may be given using the option <span style="color: #111144; font-weight: bold; white-space: pre;">--distance-to-TLS <a href="../Basics/Notation.html#Referenced_Data_Types" title="Basics/Notation"><i>&lt;FLOAT&gt;</i></a></span> (or <span style="color: #111144; font-weight: bold; white-space: pre;">-d <a href="../Basics/Notation.html#Referenced_Data_Types" title="Basics/Notation"><i>&lt;FLOAT&gt;</i></a></span>), the default is .1m. The incoming edges are followed upstream, either until a given length, defined using <span style="color: #111144; font-weight: bold; white-space: pre;">--detector-length <a href="../Basics/Notation.html#Referenced_Data_Types" title="Basics/Notation"><i>&lt;FLOAT&gt;</i></a></span> (or <span style="color: #111144; font-weight: bold; white-space: pre;">-l <a href="../Basics/Notation.html#Referenced_Data_Types" title="Basics/Notation"><i>&lt;FLOAT&gt;</i></a></span>) where the default is 250m, or another traffic light is reached or no further upstream edge exists. Entry points are generated at these points.</li></ul>
<p>In both cases, the network must be given using the option <span style="color: #111144; font-weight: bold; white-space: pre;">--net-file <a href="../Basics/Notation.html#Referenced_Data_Types" title="Basics/Notation"><i>&lt;FILE&gt;</i></a></span> (or <span style="color: #111144; font-weight: bold; white-space: pre;">-n <a href="../Basics/Notation.html#Referenced_Data_Types" title="Basics/Notation"><i>&lt;FILE&gt;</i></a></span>). The file including the detector definitions to generate may be given using the option <span style="color: #111144; font-weight: bold; white-space: pre;">--output <a href="../Basics/Notation.html#Referenced_Data_Types" title="Basics/Notation"><i>&lt;FILE&gt;</i></a></span> (or <span style="color: #111144; font-weight: bold; white-space: pre;">-o <a href="../Basics/Notation.html#Referenced_Data_Types" title="Basics/Notation"><i>&lt;FILE&gt;</i></a></span>), default is "e2.add.xml" for areal detectors, and "e3.add.xml" for multi-entry/multi-exit detectors. Per default, the areal detectors generated by <i><b>generateTLSE2Detectors.py</b></i> are writing their measures to "e2output.xml", the multi-entry/multi-exit detectors generated by <i><b>generateTLSE2Detectors.py</b></i> to "e3output.xml". The output file name can be changed for both scripts using the option <span style="color: #111144; font-weight: bold; white-space: pre;">--results-file <a href="../Basics/Notation.html#Referenced_Data_Types" title="Basics/Notation"><i>&lt;FILE&gt;</i></a></span> (or <span style="color: #111144; font-weight: bold; white-space: pre;">-r <a href="../Basics/Notation.html#Referenced_Data_Types" title="Basics/Notation"><i>&lt;FILE&gt;</i></a></span>). The frequency of generated reports is 60s per default. It can be changed using the option <span style="color: #111144; font-weight: bold; white-space: pre;">--frequency <a href="../Basics/Notation.html#Referenced_Data_Types" title="Basics/Notation"><i>&lt;INT&gt;</i></a></span> (or <span style="color: #111144; font-weight: bold; white-space: pre;">-f <a href="../Basics/Notation.html#Referenced_Data_Types" title="Basics/Notation"><i>&lt;INT&gt;</i></a></span>).
</p>
<h1><span class="mw-headline" id="Controlling_traffic_lights_via_TraCI">Controlling traffic lights via TraCI</span></h1>
<p><a href="../TraCI/Change_Traffic_Lights_State.html" title="TraCI/Change Traffic Lights State">TraCI provides various functions for controlling traffic lights</a>. And the basic approaches are outline below
</p>
<h2><span class="mw-headline" id="Setting_the_phase">Setting the phase</span></h2>
<p>A common pattern for implementing adaptive control via TraCI  is to load a program where all green phases have a long duration (i.e. 1000s) to avoid switching by SUMO and then use the <b>setPhase</b> function to switch to the next phase as appropriate. The nice thing about this approach is, that yellow and all-red phases can still be handled automatically by SUMO and the control script simply determines the duration of the current green phase.
</p><p>To implement controllers with branching phase transitions, the phase attribute <span class="inlxml">next</span> can be used to indicated the next phase. This is useful when adding additional transition phases to the end of a fixed cycle program.
</p><p>Tutorials for controlling traffic lights in this way can be found at <a href="../Tutorials.html#TraCI_Tutorials" title="Tutorials">Tutorials#TraCI_Tutorials</a>.
</p>
<h2><span class="mw-headline" id="Setting_the_duration">Setting the duration</span></h2>
<p>Using the function <b>setPhaseDuration</b>, the remaining duration for the current phase can be modified. Note, that this does not take effect when encountering the same phase again in the next phase cycle.
</p>
<h2><span class="mw-headline" id="Setting_the_state">Setting the state</span></h2>
<p>Another method for controlling the traffic light is to set the signal state for all links directly using the function <i>setRedYellowGreenState</i>. After using this function, SUMO will not modify the state anymore. 
Consequently, the script must handle all phases and transitions.
</p>
<h2><span class="mw-headline" id="Setting_the_complete_Program">Setting the complete Program</span></h2>
<p>Using the method <b>setCompleteRedYellowGreenDefinition</b>, a static signal plan can be loaded. Since this method requires a complex data structure as argument, it is recommend to first obtain a data structure using <b>getCompleteRedYellowGreenDefinition</b> and then modify it
</p>
<h2><span class="mw-headline" id="Switching_between_pre-defined_Programs">Switching between pre-defined Programs</span></h2>
<p>SUMO can load multiple traffic light programs from the <i>.net.mxl</i> file and from <a href="#Defining_New_TLS-Programs">additioal files</a>. Using the traci function <b>setProgram</b>, a script can switch between them.
</p>
<!-- 
NewPP limit report
Cached time: 20190415221548
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.043 seconds
Real time usage: 0.048 seconds
Preprocessor visited node count: 562/1000000
Preprocessor generated node count: 1436/1000000
Post‐expand include size: 6551/2097152 bytes
Template argument size: 2357/2097152 bytes
Highest expansion depth: 3/40
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 2986/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%   14.037      1 -total
 40.13%    5.633     28 Template:Option
  9.97%    1.399     13 Template:XML
  7.13%    1.001      2 Template:Note
  7.11%    0.998      2 Template:Caution
  6.98%    0.980      5 Template:AdditionalFile
  6.80%    0.954      9 Template:DT_FLOAT
  6.79%    0.952      6 Template:DT_FILE
  6.44%    0.904      2 Template:DT_INT
  6.43%    0.902      2 Template:SUMO
-->

<!-- Saved in parser cache with key wiki:pcache:idhash:231-0!canonical and timestamp 20190415221548 and revision id 12016
 -->
</div></div>					</div><hr/><div id="lastmod"></div> </div>

    <div id="footer">
      <div>
        (c) 2011-2017, German Aerospace Center, Institute of
        Transportation Systems
      </div>

      <div>
        Layout based on <a href=
        "http://www.oswd.org/design/preview/id/3365">"Three
        Quarters"</a> by "SimplyGold"
      </div>
    </div>
  </div>
</body>
</html>
